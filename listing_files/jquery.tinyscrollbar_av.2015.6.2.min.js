(function(b){function y(g,a){var n,r,s;function x(a){b("body").addClass("noSelect");b("body").bind("mousedown.disableTextSelect selectstart.disableTextSelect",function(){return!1});var d=parseInt(f.obj.css(l),10);n=p?a.pageX:a.pageY;r="auto"==d?0:d;u?(document.ontouchmove=function(a){a.preventDefault();t(a.touches[0])},document.ontouchend=q):(b(document).bind("mousemove",t),b(document).bind("mouseup",q),f.obj.bind("mouseup",q))}function v(c){1>d.ratio&&(c=c||window.event,e-=(c.wheelDelta?c.wheelDelta/ 120:-c.detail/3)*a.wheel,e=Math.min(d[a.axis]-k[a.axis],Math.max(0,e)),f.obj.css(l,e/m.ratio),d.obj.css(l,-e),a.lockscroll||e!==d[a.axis]-k[a.axis]&&0!==e)&&(c=b.event.fix(c),c.preventDefault())}function t(c){1>d.ratio&&(s=a.invertscroll&&u?Math.min(h[a.axis]-f[a.axis],Math.max(0,r+(n-(p?c.pageX:c.pageY)))):Math.min(h[a.axis]-f[a.axis],Math.max(0,r+((p?c.pageX:c.pageY)-n))),e=s*m.ratio,d.obj.css(l,-e),f.obj.css(l,s))}function q(){b("body").removeClass("noSelect");b("body").unbind("mousedown.disableTextSelect selectstart.disableTextSelect"); b(document).unbind("mousemove",t);b(document).unbind("mouseup",q);f.obj.unbind("mouseup",q);document.ontouchmove=document.ontouchend=null}var k={obj:b(".viewport",g)},d={obj:b(".overview",g)},m={obj:b(".scrollbar",g)},h={obj:b(".track",m.obj)},f={obj:b(".thumb",m.obj)},p="x"===a.axis,l=p?"left":"top",w=p?"Width":"Height",e=0;s=r=0;n=void 0;var u="ontouchstart"in document.documentElement;this.update=function(c){k[a.axis]=k.obj[0]["offset"+w];d[a.axis]=d.obj[0]["scroll"+w];d.ratio=k[a.axis]/d[a.axis]; m.obj.toggleClass("disable",1<=d.ratio);h[a.axis]="auto"===a.size?k[a.axis]:a.size;f[a.axis]=Math.min(h[a.axis],Math.max(0,"auto"===a.sizethumb?h[a.axis]*d.ratio:a.sizethumb));m.ratio="auto"===a.sizethumb?d[a.axis]/h[a.axis]:(d[a.axis]-k[a.axis])/(h[a.axis]-f[a.axis]);e="relative"===c&&1>=d.ratio?Math.min(d[a.axis]-k[a.axis],Math.max(0,e)):0;e="bottom"===c&&1>=d.ratio?d[a.axis]-k[a.axis]:isNaN(parseInt(c,10))?e:parseInt(c,10);c=w.toLowerCase();f.obj.css(l,e/m.ratio);d.obj.css(l,-e);n=f.obj.offset()[l]; m.obj.css(c,h[a.axis]);h.obj.css(c,h[a.axis]);f.obj.css(c,f[a.axis])};this.update();(function(){u?k.obj[0].ontouchstart=function(a){1===a.touches.length&&(x(a.touches[0]),a.stopPropagation())}:(f.obj.bind("mousedown",x),h.obj.bind("mouseup",t));a.scroll&&window.addEventListener?(g[0].addEventListener("DOMMouseScroll",v,!1),g[0].addEventListener("mousewheel",v,!1),g[0].addEventListener("MozMousePixelScroll",function(a){a.preventDefault()},!1)):a.scroll&&(g[0].onmousewheel=v)})();return this}b.tiny= b.tiny||{};b.tiny.scrollbar={options:{axis:"y",wheel:40,scroll:!0,lockscroll:!0,size:"auto",sizethumb:"auto",invertscroll:!1}};b.fn.tinyscrollbar=function(g){var a=b.extend({},b.tiny.scrollbar.options,g);this.each(function(){b(this).data("tsb",new y(b(this),a))});return this};b.fn.tinyscrollbar_update=function(g){return b(this).data("tsb").update(g)}})(jQuery);